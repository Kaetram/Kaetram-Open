<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../../../../">
  <title data-ice="title">Kaetram-Open/client/js/interface/profile/pages/quest.js | kaetram</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Kaetram is an open-source game-engine created to aid those interested in entering the game development realm. The codebase is simple, clean, and intuitive, and is intended to be used as a learning tool. The original idea is based off Little Workshop&apos;s demo game - BrowserQuest. The assets have remained the same, but the code itself has been completely wiped and redone from the ground up."><meta property="twitter:card" content="summary"><meta property="twitter:title" content="kaetram"><meta property="twitter:description" content="Kaetram is an open-source game-engine created to aid those interested in entering the game development realm. The codebase is simple, clean, and intuitive, and is intended to be used as a learning tool. The original idea is based off Little Workshop&apos;s demo game - BrowserQuest. The assets have remained the same, but the code itself has been completely wiped and redone from the ground up."></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/Veradictus/Kaetram-Open"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  </ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">Kaetram-Open/client/js/interface/profile/pages/quest.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">define([&apos;jquery&apos;, &apos;../page&apos;], function($, Page) {
    return Page.extend({
        init: function() {
            var self = this;

            self._super(&apos;#questPage&apos;);

            self.achievements = $(&apos;#achievementList&apos;);
            self.quests = $(&apos;#questList&apos;);

            self.achievementsCount = $(&apos;#achievementCount&apos;);
            self.questCount = $(&apos;#questCount&apos;);

            self.achievementsList = self.achievements.find(&apos;ul&apos;);
            self.questList = self.quests.find(&apos;ul&apos;);
        },

        loadAchievements: function(achievements) {
            var self = this,
                finishedAchievements = 0;

            _.each(achievements, function(achievement) {
                var item = self.getItem(false, achievement.id),
                    name = self.getName(false, achievement.id);

                name.text(&apos;????????&apos;);

                name.css(&apos;background&apos;, &apos;rgba(255, 10, 10, 0.3)&apos;);

                if (achievement.progress &gt; 0 &amp;&amp; achievement.progress &lt; 9999) {
                    name.css(&apos;background&apos;, &apos;rgba(255, 255, 10, 0.4)&apos;);

                    name.text(
                        achievement.name +
                            (achievement.count &gt; 2
                                ? &apos; &apos; +
                                  (achievement.progress - 1) +
                                  &apos;/&apos; +
                                  (achievement.count - 1)
                                : &apos;&apos;)
                    );
                } else if (achievement.progress &gt; 9998) {
                    name.text(achievement.name);
                    name.css(&apos;background&apos;, &apos;rgba(10, 255, 10, 0.3)&apos;);
                }

                if (achievement.finished) finishedAchievements++;

                item.append(name);

                var listItem = $(&apos;&lt;li&gt;&lt;/li&gt;&apos;);

                listItem.append(item);

                self.achievementsList.append(listItem);
            });

            self.achievementsCount.html(
                finishedAchievements + &apos;/&apos; + achievements.length
            );
        },

        loadQuests(quests) {
            var self = this,
                finishedQuests = 0;

            _.each(quests, function(quest) {
                var item = self.getItem(true, quest.id),
                    name = self.getName(true, quest.id);

                name.text(quest.name);

                name.css(&apos;background&apos;, &apos;rgba(255, 10, 10, 0.3)&apos;);

                if (quest.stage &gt; 0 &amp;&amp; quest.stage &lt; 9999)
                    name.css(&apos;background&apos;, &apos;rgba(255, 255, 10, 0.4)&apos;);
                else if (quest.stage &gt; 9998)
                    name.css(&apos;background&apos;, &apos;rgba(10, 255, 10, 0.3)&apos;);

                if (quest.finished) finishedQuests++;

                item.append(name);

                var listItem = $(&apos;&lt;li&gt;&lt;/li&gt;&apos;);

                listItem.append(item);

                self.questList.append(listItem);
            });

            self.questCount.html(finishedQuests + &apos;/&apos; + quests.length);
        },

        progress: function(info) {
            var self = this,
                item = info.isQuest
                    ? self.getQuest(info.id)
                    : self.getAchievement(info.id);

            if (!item) return;

            var name = item.find(
                &apos;&apos; +
                    (info.isQuest ? &apos;#quest&apos; : &apos;#achievement&apos;) +
                    info.id +
                    &apos;name&apos;
            );

            if (!name) return;

            if (!info.isQuest &amp;&amp; info.count &gt; 2) {
                name.text(
                    info.name + &apos; &apos; + info.progress + &apos;/&apos; + (info.count - 1)
                );
            } else name.text(info.name);

            name.css(&apos;background&apos;, &apos;rgba(255, 255, 10, 0.4)&apos;);
        },

        finish: function(info) {
            var self = this,
                item = info.isQuest
                    ? self.getQuest(info.id)
                    : self.getAchievement(info.id);

            if (!item) return;

            var name = item.find(
                &apos;&apos; +
                    (info.isQuest ? &apos;#quest&apos; : &apos;#achievement&apos;) +
                    info.id +
                    &apos;name&apos;
            );

            if (!name) return;

            if (!info.isQuest) name.text(info.name);

            name.css(&apos;background&apos;, &apos;rgba(10, 255, 10, 0.3)&apos;);
        },

        getQuest: function(id) {
            return $(this.questList.find(&apos;li&apos;)[id]).find(&apos;#quest&apos; + id);
        },

        getAchievement: function(id) {
            return $(this.achievementsList.find(&apos;li&apos;)[id]).find(
                &apos;#achievement&apos; + id
            );
        },

        /**
         * Might as well properly organize them based
         * on their type of item and id (index).
         */

        getItem: function(isQuest, id) {
            return $(
                &apos;&lt;div id=&quot;&apos; +
                    (isQuest ? &apos;quest&apos; : &apos;achievement&apos;) +
                    id +
                    &apos;&quot; class=&quot;questItem&quot;&gt;&lt;/div&gt;&apos;
            );
        },

        getName: function(isQuest, id) {
            return $(
                &apos;&lt;div id=&quot;&apos; +
                    (isQuest ? &apos;quest&apos; : &apos;achievement&apos;) +
                    id +
                    &apos;name&quot; class=&quot;questName&quot;&gt;&lt;/div&gt;&apos;
            );
        }
    });
});
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
