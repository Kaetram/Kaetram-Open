<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../../">
  <title data-ice="title">Kaetram-Open/client/js/network/messages.js | kaetram</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Kaetram is an open-source game-engine created to aid those interested in entering the game development realm. The codebase is simple, clean, and intuitive, and is intended to be used as a learning tool. The original idea is based off Little Workshop&apos;s demo game - BrowserQuest. The assets have remained the same, but the code itself has been completely wiped and redone from the ground up."><meta property="twitter:card" content="summary"><meta property="twitter:title" content="kaetram"><meta property="twitter:description" content="Kaetram is an open-source game-engine created to aid those interested in entering the game development realm. The codebase is simple, clean, and intuitive, and is intended to be used as a learning tool. The original idea is based off Little Workshop&apos;s demo game - BrowserQuest. The assets have remained the same, but the code itself has been completely wiped and redone from the ground up."></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/Veradictus/Kaetram-Open"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  </ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">Kaetram-Open/client/js/network/messages.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/* global log, _, Packets */

define(function() {
    return Class.extend({

        /**
         * Do not clutter up the Socket class with callbacks,
         * have this class here until a better method arises in my head.
         *
         * This class should not have any complex functionality, its main
         * role is to provide organization for packets and increase readability
         *
         * Please respect the order of the Packets Enum and arrange functions
         * accordingly.
         */

        init: function(app) {
            var self = this;

            self.app = app;

            self.messages = [];

            self.messages[Packets.Handshake] = self.receiveHandshake;
            self.messages[Packets.Welcome] = self.receiveWelcome;
            self.messages[Packets.Spawn] = self.receiveSpawn;
            self.messages[Packets.Equipment] = self.receiveEquipment;
            self.messages[Packets.List] = self.receiveEntityList;
            self.messages[Packets.Sync] = self.receiveSync;
            self.messages[Packets.Movement] = self.receiveMovement;
            self.messages[Packets.Teleport] = self.receiveTeleport;
            self.messages[Packets.Despawn] = self.receiveDespawn;
            self.messages[Packets.Combat] = self.receiveCombat;
            self.messages[Packets.Animation] = self.receiveAnimation;
            self.messages[Packets.Projectile] = self.receiveProjectile;
            self.messages[Packets.Population] = self.receivePopulation;
            self.messages[Packets.Points] = self.receivePoints;
            self.messages[Packets.Network] = self.receiveNetwork;
            self.messages[Packets.Chat] = self.receiveChat;
            self.messages[Packets.Command] = self.receiveCommand;
            self.messages[Packets.Inventory] = self.receiveInventory;
            self.messages[Packets.Bank] = self.receiveBank;
            self.messages[Packets.Ability] = self.receiveAbility;
            self.messages[Packets.Quest] = self.receiveQuest;
            self.messages[Packets.Notification] = self.receiveNotification;
            self.messages[Packets.Blink] = self.receiveBlink;
            self.messages[Packets.Heal] = self.receiveHeal;
            self.messages[Packets.Experience] = self.receiveExperience;
            self.messages[Packets.Death] = self.receiveDeath;
            self.messages[Packets.Audio] = self.receiveAudio;
            self.messages[Packets.NPC] = self.receiveNPC;
            self.messages[Packets.Respawn] = self.receiveRespawn;
            self.messages[Packets.Enchant] = self.receiveEnchant;
            self.messages[Packets.Guild] = self.receiveGuild;
            self.messages[Packets.Pointer] = self.receivePointer;
            self.messages[Packets.PVP] = self.receivePVP;
            self.messages[Packets.Shop] = self.receiveShop;
            self.messages[Packets.Minigame] = self.receiveMinigame;
            self.messages[Packets.Region] = self.receiveRegion;
            self.messages[Packets.Overlay] = self.receiveOverlay;
            self.messages[Packets.Camera] = self.receiveCamera;
        },

        handleData: function(data) {
            var self = this,
                packet = data.shift();

            if (self.messages[packet] &amp;&amp; _.isFunction(self.messages[packet]))
                self.messages[packet].call(self, data);
        },

        handleBulkData: function(data) {
            var self = this;

            _.each(data, function(message) {
                self.handleData(message);
            });
        },

        handleUTF8: function(message) {
            var self = this;

            self.app.toggleLogin(false);

            switch (message) {
                case &apos;updated&apos;:
                    self.app.sendError(null, &apos;The client has been updated!&apos;);
                    break;

                case &apos;full&apos;:
                    self.app.sendError(null, &apos;The servers are currently full!&apos;);
                    break;

                case &apos;error&apos;:
                    self.app.sendError(null, &apos;The server has responded with an error!&apos;);
                    break;

                case &apos;development&apos;:
                    self.app.sendError(null, &apos;The game is currently in development mode.&apos;);
                    break;

                case &apos;disallowed&apos;:
                    self.app.sendError(null, &apos;The server is currently not accepting connections!&apos;);
                    break;

                case &apos;maintenance&apos;:
                    self.app.sendError(null, &apos;Kaetram is currently under maintenance.&apos;);
                    break;

                case &apos;userexists&apos;:
                    self.app.sendError(null, &apos;The username you have chosen already exists.&apos;);
                    break;

                case &apos;emailexists&apos;:
                    self.app.sendError(null, &apos;The email you have chosen is not available.&apos;);
                    break;

                case &apos;loggedin&apos;:
                    self.app.sendError(null, &apos;The player is already logged in!&apos;);
                    break;

                case &apos;invalidlogin&apos;:
                    self.app.sendError(null, &apos;You have entered the wrong username or password.&apos;);
                    break;

                case &apos;toofast&apos;:
                    self.app.sendError(null, &apos;You are trying to log in too fast from the same connection.&apos;);
                    break;

                case &apos;malform&apos;:

                    self.app.game.handleDisconnection(true);
                    self.app.sendError(null, &apos;Client has experienced a malfunction.&apos;);

                    break;

                case &apos;timeout&apos;:

                    self.app.sendError(null, &apos;You have been disconnected for being inactive for too long.&apos;);

                    break;

                default:
                    self.app.sendError(null, &apos;An unknown error has occurred, please refer to the forums.&apos;);
                    break;
            }
        },

        /**
         * Data Receivers
         */

        receiveHandshake: function(data) {
            var self = this,
                info = data.shift();

            if (self.handshakeCallback)
                self.handshakeCallback(info);
        },

        receiveWelcome: function(data) {
            var self = this,
                playerData = data.shift();

            if (self.welcomeCallback)
                self.welcomeCallback(playerData);
        },

        receiveSpawn: function(data) {
            var self = this;

            if (self.spawnCallback)
                self.spawnCallback(data);
        },

        receiveEquipment: function(data) {
            var self = this,
                equipType = data.shift(),
                equipInfo = data.shift();

            if (self.equipmentCallback)
                self.equipmentCallback(equipType, equipInfo);
        },

        receiveEntityList: function(data) {
            var self = this;

            if (self.entityListCallback)
                self.entityListCallback(data);
        },

        receiveSync: function(data) {
            var self = this;

            if (self.syncCallback)
                self.syncCallback(data.shift());
        },

        receiveMovement: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.movementCallback)
                self.movementCallback(opcode, info);
        },

        receiveTeleport: function(data) {
            var self = this,
                info = data.shift();

            if (self.teleportCallback)
                self.teleportCallback(info);
        },

        receiveDespawn: function(data) {
            var self = this,
                id = data.shift();

            if (self.despawnCallback)
                self.despawnCallback(id);
        },

        receiveCombat: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.combatCallback)
                self.combatCallback(opcode, info);
        },

        receiveAnimation: function(data) {
            var self = this,
                id = data.shift(),
                info = data.shift();

            if (self.animationCallback)
                self.animationCallback(id, info);
        },

        receiveProjectile: function(data) {
            var self = this,
                type = data.shift(),
                info = data.shift();

            if (self.projectileCallback)
                self.projectileCallback(type, info);
        },

        receivePopulation: function(data) {
            var self = this;

            if (self.populationCallback)
                self.populationCallback(data.shift());
        },

        receivePoints: function(data) {
            var self = this,
                pointsData = data.shift();

            if (self.pointsCallback)
                self.pointsCallback(pointsData);
        },

        receiveNetwork: function(data) {
            var self = this,
                opcode = data.shift();

            if (self.networkCallback)
                self.networkCallback(opcode);
        },

        receiveChat: function(data) {
            var self = this,
                info = data.shift();

            if (self.chatCallback)
                self.chatCallback(info);
        },

        receiveCommand: function(data) {
            var self = this,
                info = data.shift();

            if (self.commandCallback)
                self.commandCallback(info);
        },

        receiveInventory: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.inventoryCallback)
                self.inventoryCallback(opcode, info);
        },

        receiveBank: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.bankCallback)
                self.bankCallback(opcode, info);
        },

        receiveAbility: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.abilityCallback)
                self.abilityCallback(opcode, info);
        },

        receiveQuest: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.questCallback)
                self.questCallback(opcode, info);
        },

        receiveNotification: function(data) {
            var self = this,
                opcode = data.shift(),
                message = data.shift();

            if (self.notificationCallback)
                self.notificationCallback(opcode, message);
        },

        receiveBlink: function(data) {
            var self = this,
                instance = data.shift();

            if (self.blinkCallback)
                self.blinkCallback(instance);
        },

        receiveHeal: function(data) {
            var self = this;

            if (self.healCallback)
                self.healCallback(data.shift());
        },

        receiveExperience: function(data) {
            var self = this;

            if (self.experienceCallback)
                self.experienceCallback(data.shift());
        },

        receiveDeath: function(data) {
            var self = this;

            if (self.deathCallback)
                self.deathCallback(data.shift());
        },

        receiveAudio: function(data) {
            var self = this;

            if (self.audioCallback)
                self.audioCallback(data.shift());
        },

        receiveNPC: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.npcCallback)
                self.npcCallback(opcode, info);
        },

        receiveRespawn: function(data) {
            var self = this,
                id = data.shift(),
                x = data.shift(),
                y = data.shift();

            if (self.respawnCallback)
                self.respawnCallback(id, x, y);
        },

        receiveEnchant: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.enchantCallback)
                self.enchantCallback(opcode, info);
        },

        receiveGuild: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.guildCallback)
                self.guildCallback(opcode, info);
        },

        receivePointer: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.pointerCallback)
                self.pointerCallback(opcode, info);
        },

        receivePVP: function(data) {
            var self = this,
                id = data.shift(),
                pvp = data.shift();

            if (self.pvpCallback)
                self.pvpCallback(id, pvp);
        },

        receiveShop: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.shopCallback)
                self.shopCallback(opcode, info);
        },

        receiveMinigame: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.minigameCallback)
                self.minigameCallback(opcode, info);
        },

        receiveRegion: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift(),
                force = data.shift();

            if (self.regionCallback)
                self.regionCallback(opcode, info, force);
        },

        receiveOverlay: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.overlayCallback)
                self.overlayCallback(opcode, info);
        },

        receiveCamera: function(data) {
            var self = this,
                opcode = data.shift(),
                info = data.shift();

            if (self.cameraCallback)
                self.cameraCallback(opcode, info);
        },

        /**
         * Universal Callbacks
         */

        onHandshake: function(callback) {
            this.handshakeCallback = callback;
        },

        onWelcome: function(callback) {
            this.welcomeCallback = callback;
        },

        onSpawn: function(callback) {
            this.spawnCallback = callback;
        },

        onEquipment: function(callback) {
            this.equipmentCallback = callback;
        },

        onEntityList: function(callback) {
            this.entityListCallback = callback;
        },

        onSync: function(callback) {
            this.syncCallback = callback;
        },

        onMovement: function(callback) {
            this.movementCallback = callback;
        },

        onTeleport: function(callback) {
            this.teleportCallback = callback;
        },

        onDespawn: function(callback) {
            this.despawnCallback = callback;
        },

        onCombat: function(callback) {
            this.combatCallback = callback;
        },

        onAnimation: function(callback) {
            this.animationCallback = callback;
        },

        onProjectile: function(callback) {
            this.projectileCallback = callback;
        },

        onPopulation: function(callback) {
            this.populationCallback = callback;
        },

        onPoints: function(callback) {
            this.pointsCallback = callback;
        },

        onNetwork: function(callback) {
            this.networkCallback = callback;
        },

        onChat: function(callback) {
            this.chatCallback = callback;
        },

        onCommand: function(callback) {
            this.commandCallback = callback;
        },

        onInventory: function(callback) {
            this.inventoryCallback = callback;
        },

        onBank: function(callback) {
            this.bankCallback = callback;
        },

        onAbility: function(callback) {
            this.abilityCallback = callback;
        },

        onQuest: function(callback) {
            this.questCallback = callback;
        },

        onNotification: function(callback) {
            this.notificationCallback = callback;
        },

        onBlink: function(callback) {
            this.blinkCallback = callback;
        },

        onHeal: function(callback) {
            this.healCallback = callback;
        },

        onExperience: function(callback) {
            this.experienceCallback = callback;
        },

        onDeath: function(callback) {
            this.deathCallback = callback;
        },

        onAudio: function(callback) {
            this.audioCallback = callback;
        },

        onNPC: function(callback) {
            this.npcCallback = callback;
        },

        onRespawn: function(callback) {
            this.respawnCallback = callback;
        },

        onEnchant: function(callback) {
            this.enchantCallback = callback;
        },

        onGuild: function(callback) {
            this.guildCallback = callback;
        },

        onPointer: function(callback) {
            this.pointerCallback = callback;
        },

        onPVP: function(callback) {
            this.pvpCallback = callback;
        },

        onShop: function(callback) {
            this.shopCallback = callback;
        },

        onMinigame: function(callback) {
            this.minigameCallback = callback;
        },

        onRegion: function(callback) {
            this.regionCallback = callback;
        },

        onOverlay: function(callback) {
            this.overlayCallback = callback;
        },

        onCamera: function(callback) {
            this.cameraCallback = callback;
        }

    });
});
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
